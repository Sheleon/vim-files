-module(example).
-export([start/0]).

start() ->
    code:add_patha("jiffy/ebin"), % json library
    code:add_patha("mochiweb/ebin"), % json library
    DataAsTuple = {[
        {foo, <<"bar">>},
        {food, <<"barf">>},
        {good, <<"bars">>},
        {dood, <<"where your car?">>},
        {<<"wheres your car">>, <<"dude">>}
    ]},
    DataAsString = loads(DataAsTuple),
    MicroSecondsPerSecond = one_million(),
    io:format("DUM\n",[]),
    timer:start(),
    {RunTimeMs, _} = timer:tc( 
        fun() -> 
            lists:map( 
                fun(_) -> 
                    dumps(DataAsString), 
                    ok 
                end, 
                lists:seq(1, one_million())
            ), 
           ok 
        end
    ),
    RunTimeMs / MicroSecondsPerSecond.

loads(X) ->
    mochijson2:encode(X).
    %jiffy:encode(X).

dumps(Z) ->
    mochijson2:decode(X).
    %jiffy:decode(Z).

one_million() ->
    1000000.
