%% run client unit tests and expose for erlang via tests()
-module(protocol_tests).
-export([tests/0]).

%% XXX: This requires magic of the makefile to put the stuff in priv
tests() ->
    TestCmd = io_lib:format( "cd \"~s/ole-reference-protocol\" && ./test.sh", [code:priv_dir(external_tests)]),
    io:format("Protocol Test: ~s~n", [TestCmd]),
    Txt = os:cmd(TestCmd),
    Args = common_tests:parse_external_unittests(Txt, []),
    Results = [{list_to_atom(Atom), common_tests:is_ok(Msg)} || [Atom, Msg] <- lists:reverse(Args)],
    {tests, Results}.
